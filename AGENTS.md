# AGENTS.md — 이 프로젝트에서 Codex(에이전트)가 일하는 규칙

> Project OS: **v1 (legacy)** — 템플릿 정본(Lean v2)과 게이트/템플릿 구조가 다를 수 있습니다.

## 0) 이 문서의 목적

- Codex가 이 repo에서 **항상 같은 방식**(문서→구현→테스트→리포트)으로 일하게 합니다.

---

## 1) 절대 규칙(꼭 지킬 것)

1) **대화로 끝내지 말고, repo에 파일(산출물)로 남긴다.**
2) **작게 바꾼다.** 큰 리팩토링/전체 재작성 금지(필요하면 먼저 계획/승인).
3) **의존성/툴 추가는 사전 확인**(프로덕션 영향 가능).
4) **비밀정보(키/토큰/개인정보) 노출 금지.** 로그에도 찍지 말기.
5) “완료”라고 하기 전에 **테스트/린트(가능한 범위)** 실행.

---

## 2) 이 프로젝트의 산출물(문서) 위치 = ‘정답 파일’

> 아래 경로에 파일이 없으면 만들고, 있으면 그 파일을 기준으로 움직입니다.

- PM: `00_charter/PROJECT.md`
- 기획(Planner): `10_requirements/PRD.md`
- 디자인(Designer): `20_design/UI_SPEC.md` (UI가 있거나 필요할 때)
- 개발(Dev/Backend): `30_architecture/TECH_SPEC.md`
- QA: `50_quality/TESTPLAN.md`, `50_quality/TEST_REPORT.md`
- 배포/발표: `99_delivery/RELEASE.md`, `99_delivery/DEMO_SCRIPT.md`

### 추적 ID 규칙(서로 연결하는 번호)

- US-### (유저스토리)
- FR-### (기능요구)
- NFR-### (비기능)
- UI-### (화면)
- CMP-### (컴포넌트)
- TC-### (테스트)
- ADR-### (의사결정)

---

## 3) 게이트(통과 순서)

### Gate A: 요구사항(만들기 전에)

- PRD에 수용기준(AC: 테스트 가능한 문장) 이 있어야 합니다.
- P0 항목은 최소한 US/FR/UI/TC 연결이 시작되어야 합니다.

### Gate B: 구현(코드 변경 후)

- 관련 테스트/린트 실행(가능한 범위).
- 실패 시: “왜 실패했는지/대안/다음 행동”을 문서로 남깁니다.

### Gate C: QA(릴리즈 전)

- QA가 `50_quality/TEST_REPORT.md` 작성:
  - 무엇을 테스트했는지
  - 무엇이 실패했는지
  - 실패 재현 방법(단계/기대값 vs 실제)

### Gate D: 최종 결정

- Risk 역할이 반대 의견/실패 시나리오/완화책을 제시
- PM이 최종 결정을 문서(또는 ADR)로 남김

---

## 4) 큰 작업은 반드시 ExecPlan으로 시작

- 2시간 넘을 일, 여러 파일/모듈을 건드릴 일, 위험한 변경(보안/DB/배포)은 먼저
  `.agent/PLANS.md` 규칙을 읽고 **ExecPlan을 파일로 작성**합니다.
- ExecPlan 파일은 `.agent/execplans/` 폴더에 만듭니다.

---

## 5) 테스트/린트 실행 방법(먼저 ‘찾고’, 그 다음 실행)

- 먼저 repo에서 아래를 찾아 “표준 커맨드”를 확인합니다:
  - Makefile, package.json, pyproject.toml, CI 설정, README
- 그 다음 그 표준 커맨드로 테스트/린트를 실행합니다.
- 모르면: “표준 커맨드를 찾는 과정”을 먼저 기록하고 진행합니다.

---

> 주의: 이 파일은 짧고 강제력 있게 유지하는 게 좋습니다.
> 너무 길면 Codex instruction chain이 잘릴 수 있어, 디테일은 `.agent/PLANS.md`로 둡니다.
